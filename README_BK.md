<img src="https://img.shields.io/badge/servrox-approved-brightgreen.svg?style=flat&link=http://servrox.solutions&link=http://servrox.solutions&logo=data:image/png;base64,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" />

# Nx Workspace with Angular Universal via Nest

This project was generated using [Nx](https://nx.dev).
It currently includes an [Angular](https://angular.io/guide/universal) App with server side rendering (SSR) via [Nest](https://nestjs.com/).

[master](https://github.com/servrox/nx-ng-nest-universal/tree/master) branch -> nx workspace with two apps (angular + nest) -> Step 1. - 6.<br/>
[single-app](https://github.com/servrox/nx-ng-nest-universal/tree/single-app) branch -> nx workspace with single app (angular) -> Step 1. - 4.

<p float="left">
<img src="https://raw.githubusercontent.com/nrwl/nx/master/nx-logo.png" height="100">
<img src="https://angular.io/assets/images/logos/angular/angular.svg" height="145">
<img src="https://angular.io/generated/images/marketing/concept-icons/universal.png" height="120">
<img src="https://camo.githubusercontent.com/0d358238ba8c67946e6555aad926b947e1a5048f/68747470733a2f2f6e6573746a732e636f6d2f696d672f6c6f676f5f746578742e737667" height="120">
</p>

<br/><br/>

## Steps to Reproduce

### 1. Create Nx Workspace

```
npx create-nx-workspace nx-ng-nest-universal --npm-scope=ss --style=scss
```

### 2. Generate Angular App

```
ng g app ng-test-app --prefix=ss-test --routing=true --style=scss
```

### 3. Add Angular Universal module for Nest

```
ng add @nestjs/ng-universal --clientProject=ng-test-app --project=ng-test-app
```

### 4. Adjustments to make everything work. (s. [Commit](https://github.com/servrox/nx-ng-nest-universal/commit/211095e0cb5c722c7cb35ffaefa982bacd4aba9c))

```
1. rimraf yarn.lock && npm i (to avoid packages conflicts)
2. Fix fileReplacements for ng-test-app:server:production in angular.json
3. Edit webpack.server.config.js
```

✔️ Nx App + SSR working. Move on if you want to have nest as a seperated app in your workspace.

<br/>

### 5. Generate Nest App

```
ng g node-app nest-test-app --framework=nestjs
```

### 6. Adjustments to use the freshly generated Nest App for SSR (s. [Commit](https://github.com/servrox/nx-ng-nest-universal/commit/b448fd2cac9540448b046af37ff71dc9d991fbe9))

```
1. Mainly move and edit generated files from Step 3
2. Add @nestjs/ng-universal to nest app in workspace
```

✔️ Nx Workspace with seperated Nest App for SSR working.

<br/>

## Getting Started (Build and Serve)

```
> git clone https://github.com/servrox/nx-ng-nest-universal.git
> cd nx-ng-nest-universal\
> npm i
```

npm run build:ssr && npm run serve:ssr

```
> npm run go
```

or for development

```
> npm run serve
```

UI at http://localhost:4000/<br/>
API at http://localhost:4000/api

<br/>

## Built With

- [Angular CLI](https://github.com/angular/angular-cli) - version 7.3.9
- [Angular Universal](https://github.com/angular/universal) - version 7.1.1
- [nest](https://github.com/nestjs/nest) - version 6.2.4
- [Nx](https://github.com/nrwl/nx) - version 7.8.6

## Authors

- **Marcel Mayer** -
  [servrox.solutions](http://servrox.solutions)
